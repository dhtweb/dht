@using DhtCrawler.Service.Model
@model DhtCrawler.Service.Model.InfoHashModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = string.Format("{0} 磁力链接_高清BT_迅雷种子下载 - 磁力云磁力链接搜索引擎", Model.Name);
    ViewBag.KeyWord = string.Format("{0},磁力链接,磁力搜索,BD,BT种子,迅雷", Model.Name);
    ViewBag.Description = string.Format("查看{0}的磁力链接和BT种子下载地址。", Model.Name);
}
<div class="detail-info">
    <div class="row-fluid tor-title">
        <h2>@Model.Name</h2>
    </div>
    <div class="row-fluid tor-magnet">
        <textarea id="magnetLink" name="magnetLink" class="magnet-link" onClick="jQuery(this).select();" readonly>magnet:?xt=urn:btih:@Model.InfoHash</textarea>
        <div class="tor-button hidden-xs">
            @*<a id="AndroidPlayNow" href="http://www.lixianhezi.com/yun/" target="_blank" class="btn btn-default btn-detail" title="在线观看"><i class="icon-play icon-white"></i> 在线观看</a>
            <a id="playNow" href="http://www.lixianhezi.com/yun/" target="_blank" class="btn btn-danger btn-detail" title="@Model.Name"><i class="icon-play icon-white"></i> 网盘播放</a>*@
            <a id="copyToClipboard" data-clipboard-target="magnetLink" class="copy-button btn btn-primary btn-detail"><i class="icon-share icon-white"></i> 复制磁力链接</a>
            <a id="magnetDownload" href="magnet:?xt=urn:btih:@Model.InfoHash" class="btn btn-success btn-detail" title="使用迅雷、旋风、电驴等BT软件下载"><i class="icon-magnet icon-white"></i> 在迅雷/旋风/bitcomet中打开</a>
            <a id="QRCodeButton" class="btn btn-info btn-detail" data-toggle="modal" data-target="#QRModal" title="扫描二维码 @Model.Name"><i class="icon-qrcode"></i> 扫描二维码/手机迅雷</a>
            <!-- Modal -->
            <div class="modal fade" id="QRModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog QRStyle">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">  &times;</button>
                            <h4 class="modal-title" id="myModalLabel">手机迅雷/磁力下载等APP中打开</h4>
                        </div>
                        <div id="infoHashQrcode" class="modal-body">
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-dismiss="modal">关 闭</button>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal -->
            </div>
        </div>
        <div class="tor-button visible-xs">
            <a id="magnetDownload" href="magnet:?xt=urn:btih:@Model.InfoHash" class="btn btn-success btn-detail" title="Download"><i class="icon-magnet icon-white"></i> 磁力链接</a>
            <a id="magnetDownload" href="http://www.lixianhezi.com/yun/" class="btn btn-danger btn-detail" title="Download"><i class="icon-play icon-white"></i> 网盘播放</a>
        </div>
    </div>
    <div class="row-fluid tor-ad">
    </div>
    <div class="row-fluid tor-detail table-responsive">
        <table class="table detail table-hover">
            <tbody>
                <tr>
                    <td class="field col-md-1">Hash:</td>
                    <td>@Model.InfoHash</td>
                </tr>
                <tr>
                    <td class="field col-md-1">文件数:</td>
                    <td>@Model.FileNum</td>
                </tr>
                <tr>
                    <td class="field col-md-1">大小:</td>
                    <td>@Model.ShowFileSize</td>
                </tr>
                <tr>
                    <td class="field col-md-1">日期:</td>
                    <td>@Model.CreateTime.ToShortDateString()</td>
                </tr>
                <tr>
                    <td class="field col-md-1">热度:</td>
                    <td>@Model.DownNum</td>
                </tr>
                <tr>
                    <td class="field col-md-1">关键词:</td>
                    <td>
                        @foreach (var key in Model.KeyWords)
                        {
                            <a href="@Url.RouteUrl("list", new { keyword = key })" target="_blank">@key &nbsp;</a>
                        }
                    </td>
                </tr>
                <tr>
                    <td class="field col-md-1">分享:</td>
                    <td>
                        <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_tieba" data-cmd="tieba" title="分享到百度贴吧"></a><a href="#" class="bds_bdhome" data-cmd="bdhome" title="分享到百度新首页"></a><a href="#" class="bds_ibaidu" data-cmd="ibaidu" title="分享到百度个人中心"></a></div>
                        <script>window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": "", "bdMini": "2", "bdMiniList": false, "bdPic": "", "bdStyle": "0", "bdSize": "24" }, "share": {} }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];</script>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="row-fluid tor-ad">
    </div>
    <div class="row-fluid tor-info">
        <div class="col-md-8 tor-info-left">
            <table class="table">
                <thead>
                    <tr>
                        <th>种子详情</th>
                        <th style="text-align:right">大小</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model.Files == null || Model.Files.Count <= 0)
                    {
                        <tr>
                            <td><i class="icon-film"></i> @Model.Name</td>
                            <td style="text-align:right">@Model.ShowFileSize</td>
                        </tr>
                    }
                    else
                    {
                        var listBuilder = new System.Text.StringBuilder();
                        var stack = new Stack<Tuple<TorrentFileModel, int>>();
                        foreach (var topFile in Model.Files)
                        {

                            stack.Push(new Tuple<TorrentFileModel, int>(topFile, 0));
                            do
                            {
                                var iItem = stack.Pop();
                                var file = iItem.Item1;
                                var left = 30 * iItem.Item2;
                                if (file.Files == null || file.Files.Count <= 0)
                                {
                                    if (file.Name.StartsWith("_____padding_file"))
                                    {
                                        continue;
                                    }
                                    listBuilder.AppendFormat("<tr><td {2}><i class='icon-film'></i>{0}</td><td style='text-align:right'>{1}</td></tr>", file.Name, file.ShowFileSize, left > 0 ? $"style='padding-left:{left}px'" : "");
                                }
                                else
                                {
                                    listBuilder.AppendFormat("<tr><td {1}><i class='icon-folder-open'></i>{0}</td><td></td></tr>", file.Name, left > 0 ? $"style='padding-left:{left}px'" : "");
                                    for (var i = file.Files.Count - 1; i >= 0; i--)
                                    {
                                        var item = file.Files[i];
                                        stack.Push(new Tuple<TorrentFileModel, int>(item, iItem.Item2 + 1));
                                    }
                                }
                            }
                            while (stack.Count > 0);
                        }
                        @Html.Raw(listBuilder.ToString())
                    }
                </tbody>
            </table>
        </div>
        <div class="col-md-4 tor-info-right">
            <div class="tor-info-ad"></div>
        </div>
    </div>
</div>
@section Footer{
    <script type="text/javascript" src="~/lib/ZeroClipboard/ZeroClipboard.min.js"></script>
    <script type="text/javascript" src="~/lib/jquery-qrcode/jquery.qrcode.min.js"></script>
    <script type="text/javascript">
        $(function () {
            $("#infoHashQrcode").qrcode({
                width: 200, height: 200, text: $("#magnetLink").val()
            });
            var clip = new ZeroClipboard(document.getElementById("copyToClipboard"));
            clip.on('aftercopy', function (client, args) {
                alert("复制成功！可粘贴到迅雷等软件中下载。");
            });
        });
    </script>
}